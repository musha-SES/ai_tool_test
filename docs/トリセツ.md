# 日報要約AI & Chatwork連携ツール 取扱説明書

## 1. このツールについて

このツールは、Google Apps Script (GAS) を利用して、以下の業務を自動化します。

-   **日報の収集**: ChatworkのBOT（あなたの分身）が、各メンバーに日報の提出を依頼します。
-   **AIによる分析**: 提出された日報の内容をGemini APIが分析し、メンバーのコンディションを「非常に良い」「良い」「普通」「少し悪い」「危険」の5段階で評価します。
-   **アラート通知**: AIが「少し悪い」または「危険」と判断した場合、担当マネージャーのChatwork（マイチャット）にアラート通知を送信します。
-   **ログの蓄積**: 分析したすべての日報データとAIの評価結果を、Googleスプレッドシートに自動で記録・蓄積します。
-   **1on1トピック生成**: 特定メンバーの過去1年間の日報ログと自己評価シートのデータをAIが分析し、1on1面談で話すべきヒアリング項目を提案します。

## 2. 導入と初期設定

### STEP 1: Googleスプレッドシートの準備

1.  **新規スプレッドシート作成**: Googleドライブで新しいスプレッドシートを作成します。このファイルがツールの土台になります。
2.  **GASエディタを開く**: メニューから `拡張機能` > `Apps Script` を選択します。
3.  **コードの貼り付け**: `nippou_tool.gs` の中身をすべてコピーし、GASエディタに貼り付けて保存します。（元からあるコードは消してください）
4.  **`Chatwork設定`シートの作成**: スプレッドシートに戻り、シート名を `Chatwork設定` に変更します。1行目に以下のヘッダーを入力します。
    | A列 | B列 | C列 | D列 |
    | :--- | :--- | :--- | :--- |
    | グループ名 | 氏名 | ルームID | 役割 |
5.  **`日報ログ`シートの作成**: 新しいシートを追加し、シート名を `日報ログ` に変更します。1行目に以下のヘッダーを入力します。
    | A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 | I列 |
    | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
    | タイムスタンプ | マネージャー名 | 氏名 | 日報日付 | 今日の業務内容 | 今日の気分 | 困っていること | AI評価状態 | AI評価理由 |
6.  **`BOT質問ログ`シートの作成**: 新しいシートを追加し、シート名を `BOT質問ログ` に変更します。1行目に以下のヘッダーを入力します。
    | A列 | B列 | C列 | D列 | E列 |
    | :--- | :--- | :--- | :--- | :--- |
    | ルームID | 質問メッセージID | 送信日時 | ステータス | エラー詳細 |

### STEP 2: 各種APIキーとIDの設定

1.  **スクリプトプロパティを開く**: GASエディタの左メニューにある歯車アイコン（`プロジェクトの設定`）をクリックし、「スクリプト プロパティ」のセクションに進みます。
2.  **プロパティの追加**: `＋ スクリプト プロパティを追加` をクリックし、以下の情報を追加します。

| プロパティ名 | 値の例 | 説明 |
| :--- | :--- | :--- |
| `CHATWORK_API_KEY` | `your_chatwork_api_token` | あなたのChatwork APIトークン。 |
| `GEMINI_API_KEY` | `AIzaSy...` | あなたのGemini APIキー。 |
| `TARGET_EMPLOYEE_NAME_FOR_1ON1` | `山田太郎` | (任意) 1on1ヒアリング項目を生成したい社員の氏名。 |
| `SELF_EVALUATION_FOLDER_ID` | `your_google_drive_folder_id` | (任意) 自己評価シートが保存されているGoogleドライブのフォルダID。 |
| `SELF_EVALUATION_INPUT_SHEET_NAME` | `簡易評価入力` | (任意) 自己評価シート内のデータ入力シート名。 |

**※注意**: 定期実行の時刻など、以前スクリプトプロパティで設定していた項目は、コード内の`CONFIG`オブジェクトで管理されるようになりました。変更する場合はGASエディタ上で直接コードを編集してください。

## 3. ツールの使い方

### STEP 1: 定期実行トリガーを設定する

1.  スプレッドシートを開き、メニューの `日報AIツール` > `定期実行トリガーを設定` をクリックします。
2.  初回実行時は、Googleから承認を求められるので、許可してください。

### STEP 2: メンバーへのお願い（日報の返信ルール）

BOTからの質問メッセージに対して**Chatworkの「返信」機能を使って返信する**よう周知してください。

**【重要】** 返信メッセージの本文には、`#日報` ハッシュタグと、`業務内容：`、`気分：`、`困っていること：` のキーワードが必須です。

### STEP 3: 1on1ヒアリング項目の生成（任意）

1.  **対象者の設定**: スクリプトプロパティで `TARGET_EMPLOYEE_NAME_FOR_1ON1` などを設定します。
2.  **自己評価シートの準備**: 対象社員の自己評価シートをGoogleドライブの指定フォルダに配置します。
3.  **実行**: スプレッドシートのメニュー `日報AIツール` > `1on1ヒアリング項目生成` をクリックします。
4.  **結果の確認**: 担当マネージャーのChatwork（マイチャット）に、AIが生成したヒアリング項目が通知されます。通知メッセージは、質問とその根拠がセットで分かりやすく表示されます。

---
以上で説明を終わります。ご不明な点があれば、開発者にお問い合わせください。

最終更新日: 2025/07/11